---
# file: test.yml
- name: Test that coordinator-overlord port is allocated
  wait_for: host={{ ansible_ec2_local_ipv4|default(ansible_default_ipv4.address) }} port={{ druid_coordinator_port }}
            connect_timeout=10 state=started
  when: coordinator_overlord is defined and coordinator_overlord

- name: Test that historical port is allocated
  wait_for: host={{ ansible_ec2_public_ipv4|default(ansible_default_ipv4.address) }} port={{ druid_historical_port }}
            connect_timeout=10 state=started
  when: historical is defined and historical

- name: Test that broker port is allocated
  wait_for: host={{ ansible_ec2_public_ipv4|default(ansible_default_ipv4.address) }} port={{ druid_broker_port }}
            connect_timeout=10 state=started
  when: broker is defined and broker

- name: Test that middleManager port is allocated
  wait_for: host={{ ansible_ec2_local_ipv4|default(ansible_default_ipv4.address) }} port={{ druid_middle_manager_port }}
            connect_timeout=10 state=started
  when: middleManager is defined and middleManager

- name: Test that router port is allocated
  wait_for: host={{ ansible_ec2_public_ipv4|default(ansible_default_ipv4.address) }} port={{ druid_router_port }}
            connect_timeout=10 state=started
  when: router is defined and router
